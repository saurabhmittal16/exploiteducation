from pwn import *

e = ELF('/opt/phoenix/i486/net-two')
p = e.process()

print p.recvline()
print p.recvline()

s = p.recv()
print "Received string: " + s

res = 0

# make string 16 characters
n = 16 - len(s)
s = '\x00' * n + s

for i in range(0, len(s), 4):
    t = s[i:i+4]
    res += u32(t)

# get hexadecimal representation of result
xres = hex(res)

# remove extra byte
if (len(xres) == 11):
    xres = xres[3:]
    xres = '0x' + xres

# convert to int
data = int(xres, 16)
p.sendline(p32(data))

print p.recv()
p.close()